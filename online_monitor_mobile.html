<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>とさでん交通在線モニター</title>
<style>
:root{--bg:#061018;--panel:#07151c;--text:#e9f6ff;--muted:#86a3b8;--train-color:#ffffff;--station-bg:#062634;--station-border:#0f5c77}
html,body{height:100%;margin:0;font-family:"Yu Gothic",Meiryo,system-ui}
body{background:var(--bg);color:var(--text);overflow:hidden}
.header{display:flex;align-items:center;gap:10px;padding:8px 14px;position:relative;flex-wrap:wrap}
.title{font-size:20px;margin:0;font-weight:700}
.time-display{position:absolute;left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:10px;top:50%;margin-top:-24px}
.bigtime{font-size:48px;font-weight:700;background:transparent;border:0;color:var(--text);padding:0;font-family:monospace;letter-spacing:3px;text-align:center;min-width:220px}
.controls{margin-left:auto;display:flex;flex-direction:column;gap:6px;align-items:flex-end}
.controls-row{display:flex;gap:8px;align-items:center}
.btn{background:transparent;border:1px solid #123;padding:7px 12px;border-radius:6px;color:var(--text);cursor:pointer;font-size:14px;font-weight:500}
.btn:hover{background:rgba(255,255,255,0.05)}
.btn-play{font-size:16px;padding:10px 20px;font-weight:600;border:2px solid #0f5c77;background:rgba(15,92,119,0.2)}
.btn-play:hover{background:rgba(15,92,119,0.4)}
.select{background:transparent;border:1px solid #123;color:var(--text);padding:7px 10px;border-radius:6px;font-size:14px;font-weight:500}
.select option{background:var(--bg);color:var(--text)}
.day-selector{display:flex;align-items:center;gap:8px}
.day-label{font-size:15px;color:var(--text);font-weight:500}
.container{height:calc(100vh - 90px);padding:4px 12px 12px 12px;box-sizing:border-box;width:100%}
#svgwrap{width:100%;height:100%;display:block}
svg{width:100%;height:100%}
.station-rect{fill:var(--station-bg);stroke:var(--station-border);stroke-width:1.0;rx:6;ry:6}
.station-text{fill:var(--text);font-size:12px;text-anchor:middle;dominant-baseline:middle;pointer-events:none}
.track-line{stroke:#0f2b3b;stroke-width:8;stroke-linecap:round}
.tick{stroke:#0f2b3b;stroke-width:2}
.trip-label{fill:var(--text);font-size:12px}
.train-circle{stroke:#0007;stroke-width:0.8;fill:var(--train-color)}
.tooltip{position:fixed;pointer-events:none;display:none;background:#051720;border:1px solid #123;padding:8px;border-radius:6px;color:var(--text);z-index:40;min-width:180px;font-size:13px}
.timetable-modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);display:none;align-items:center;justify-content:center;z-index:100}
.timetable-content{background:var(--panel);border:2px solid var(--station-border);border-radius:12px;padding:20px;max-width:600px;max-height:80vh;overflow:auto;color:var(--text)}
.timetable-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid var(--station-border)}
.timetable-title{font-size:18px;font-weight:700}
.close-btn{background:transparent;border:1px solid #123;padding:6px 12px;border-radius:6px;color:var(--text);cursor:pointer;font-size:14px}
.close-btn:hover{background:rgba(255,255,255,0.1)}
.timetable-table{width:100%;border-collapse:collapse;margin-top:12px}
.timetable-table th,.timetable-table td{padding:8px 12px;text-align:left;border-bottom:1px solid rgba(15,92,119,0.3)}
.timetable-table th{background:rgba(15,92,119,0.2);font-weight:600;font-size:13px}
.timetable-table td{font-size:13px}
.timetable-info{margin-top:12px;padding:10px;background:rgba(15,92,119,0.1);border-radius:6px;font-size:13px}
.timetable-info strong{color:var(--text)}
.legend{position:fixed;left:12px;bottom:8px;color:var(--muted);font-size:13px}
#train_count{position:fixed;right:12px;bottom:12px;background:#051720;color:var(--text);padding:8px 12px;border:1px solid #123;font-size:15px;z-index:50;font-weight:600}

/* スマホ専用 */
body{overflow:auto}
.header{padding:8px;position:sticky;top:0;background:var(--bg);z-index:100;border-bottom:2px solid #123}
.title{font-size:18px}
.time-display{position:static;transform:none;margin-top:10px;justify-content:center}
.bigtime{font-size:40px;min-width:auto;letter-spacing:4px}
.controls{margin-left:0;width:100%;align-items:center;margin-top:8px}
.controls-row{gap:6px;flex-wrap:wrap;justify-content:center}
.btn{padding:8px 12px;font-size:13px}
.btn-play{padding:10px 20px;font-size:15px}
.select{padding:8px 12px;font-size:13px}
.container{height:auto;min-height:1500px;padding:20px 10px;width:100%}
#svgwrap{width:100%;height:1500px}
svg{width:100%;height:100%}
.station-text{font-size:17px;font-weight:700}
.station-rect{rx:10;ry:10;stroke-width:1.5}
.trip-label{font-size:15px;font-weight:700}
.train-circle{r:12;stroke-width:2.5}
.track-line{stroke-width:10}
.tick{stroke-width:3}
.legend{position:fixed;left:10px;bottom:10px;font-size:12px;background:rgba(6,16,24,0.9);padding:8px;border-radius:6px;border:1px solid #123}
#train_count{position:fixed;right:10px;bottom:10px;font-size:15px;padding:8px 12px}
</style>
</head>
<body>
<div class="header">
<h1 class="title">とさでん交通在線モニター</h1>
<div class="time-display">
<input id="bigTime" class="bigtime" type="text" readonly>
</div>
<div class="day-selector">
<div class="day-label">運用日</div>
<select id="dayType" class="select">
<option value="weekday">平日</option>
<option value="holiday">土日祝</option>
</select>
</div>
<div class="controls">
<div class="controls-row">
<button class="btn jump" data-s="-1">-1s</button>
<button class="btn jump" data-s="-10">-10s</button>
<button class="btn jump" data-s="-60">-1m</button>
<button class="btn jump" data-s="-600">-10m</button>
<button class="btn jump" data-s="-1800">-30m</button>
<button class="btn jump" data-s="-3600">-1h</button>
</div>
<div class="controls-row">
<button class="btn jump" data-s="1">+1s</button>
<button class="btn jump" data-s="10">+10s</button>
<button class="btn jump" data-s="60">+1m</button>
<button class="btn jump" data-s="600">+10m</button>
<button class="btn jump" data-s="1800">+30m</button>
<button class="btn jump" data-s="3600">+1h</button>
</div>
<div class="controls-row">
<button id="firstBtn" class="btn">始発</button>
<button id="nowBtn" class="btn">Now</button>
<select id="speed" class="select">
<option value="1">×1</option>
<option value="2">×2</option>
<option value="5">×5</option>
<option value="10">×10</option>
<option value="30">×30</option>
<option value="60">×60</option>
<option value="120">×120</option>
<option value="300">×300</option>
</select>
<button id="playBtn" class="btn btn-play">再生 ▶</button>
</div>
</div>
</div>
<div class="container"><div id="svgwrap"></div></div>
<div id="tooltip" class="tooltip"></div>
<div id="timetableModal" class="timetable-modal">
<div class="timetable-content">
<div class="timetable-header">
<div class="timetable-title" id="timetableTitle">時刻表</div>
<button class="close-btn" onclick="closeTimetable()">閉じる</button>
</div>
<div id="timetableBody"></div>
</div>
</div>
<div class="legend">
<strong>行先凡例</strong>
<span style="margin-left:12px">伊=伊野</span>
<span style="margin-left:12px">後=後免</span>
<span style="margin-left:12px">高=高知駅前</span>
<span style="margin-left:12px">桟=桟橋五丁目</span>
<span style="margin-left:12px">四=桟橋四丁目</span>
<span style="margin-left:12px">橋=はりまや橋</span>
<span style="margin-left:12px">朝=朝倉</span>
<span style="margin-left:12px">鏡=鏡川橋</span>
<span style="margin-left:12px">枡=枡形</span>
<span style="margin-left:12px">知=知寄町</span>
<span style="margin-left:12px">文=文珠通</span>
<span style="margin-left:12px">介=介良通</span>
<span style="margin-left:12px">領=領石通</span>
</div>
<div id="train_count">運行中: 0両</div>
<script src="monitor_mobile.js"></script>
</body>
</html>
